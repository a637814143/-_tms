# UNSW 模型在 PCAP 上的已知局限

当前代码路径提取的 PCAP 流特征使用固定的 CICIDS 风格列（`CSV_COLUMNS` 和 `numeric_feature_names()`），并在缺失时补零。这会导致：

1. **特征分布不匹配**：UNSW 模型训练阶段会根据数据自动挑选当时存在的数值列，但推理时仍沿用模型保存的 `feature_names`。当这些列在从 PCAP 提取的流字典中不存在时，`vectorize_flows` 会全部补成 0，从而让模型接收到“全零”或极低覆盖率的输入。
2. **PCAP -> CSV 固定表头**：`vectorizer` 只接受内置的 CICIDS 表头（`CSV_COLUMNS`），对 UNSW 原生表头会直接报错而不是自动对齐，这也是 CSV/PCAP 在 UNSW 模式下易出错的主要原因。

为了提升 UNSW 模型在通用 PCAP 上的可用性，需要：
- 在模型与推理链路间明确一份“公共特征子集”，仅对齐这一子集并保持相同的标准化规则；
- 在特征覆盖率过低时直接提示结果不可靠，而不是静默使用全零输入；
- 为 UNSW 风格的 CSV/PCAP 增加自适应表头/列映射逻辑，避免因表头不符而报错。
